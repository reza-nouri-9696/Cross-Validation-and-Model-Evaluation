# -*- coding: utf-8 -*-
"""Untitled21.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1kLZSgGB2TYKNFISqXz6NeIidcZwRqbrQ
"""

#create_folds.py
import pandas as pd
from sklearn import model_selection
import argparse

def create_folds(csv_file, output_file):
    df = pd.read_csv(csv_file)
    df["kfold"] = -1
    df = df.sample(frac=1).reset_index(drop=True)
    y = df.target.values
    kf = model_selection.StratifiedKFold(n_splits=5)
    for f, (t_, v_) in enumerate(kf.split(X=df, y=y)):
        df.loc[v_, 'kfold'] = f
    df.to_csv(output_file, index=False)

if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument("--input", type=str, required=True, help="Path to the input CSV file")
    parser.add_argument("--output", type=str, required=True, help="Path to the output CSV file with folds")
    args = parser.parse_args()

    create_folds(args.input, args.output)